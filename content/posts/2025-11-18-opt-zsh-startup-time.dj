# Optimize zsh startup time

æœ€è¿‘å‘ç°zshå¯åŠ¨è¶Šæ¥è¶Šæ…¢ï¼Œæœ€ç»ˆå®šä½åˆ°ä¸€ä¸ªå¾ˆå¥‡å¦™çš„åŸå› ã€‚

TLDR: fpath æ›´æ–°å¯¼è‡´ zsh ä¼šé‡åš compinit çš„ç¼“å­˜ï¼Œä»è€Œæ‹–æ…¢å¯åŠ¨é€Ÿåº¦ã€‚

å› ä¸ºä¸€äº›åŸå› ï¼Œæœ€è¿‘åœ¨é¢‘ç¹ä¿®æ”¹ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œæ¯æ¬¡åœ¨æ–‡ä»¶é‡Œä¿®æ”¹å®Œæˆ‘ä¹ æƒ¯æ˜¯åœ¨å½“å‰ç»ˆç«¯æ‰§è¡Œ `source ~/.zshrc` æ¥åŠ è½½æœ€æ–°çš„é…ç½®è€Œä¸æ˜¯é‡æ–°æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ã€‚ç„¶é¹…è¿™ä¸ªè¿‡ç¨‹ä¼šå†æ¬¡åŠ è½½ zsh çš„æ‰€æœ‰æ’ä»¶åˆ° fpath å˜é‡ä¸­ï¼Œå¯¼è‡´ fpath é‡Œå‡ºç°äº†é‡å¤çš„è·¯å¾„ã€‚è€Œæ¯æ¬¡ fpath å˜åŒ–ï¼Œzsh éƒ½ä¼šè®¤ä¸ºéœ€è¦é‡æ–°ç”Ÿæˆ compinit çš„ç¼“å­˜æ–‡ä»¶ï¼Œè€Œä½ ä¸‹ä¸€æ¬¡æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯æ—¶ï¼Œfpathåˆæ¢å¤æ­£å¸¸ï¼ˆä¹Ÿå˜åŒ–äº†ï¼‰ï¼Œzsh å°±åˆä¼šé‡æ–°æ‰§è¡Œ compinit çš„è¿‡ç¨‹ã€‚

quote from Mr.GPT
> ğŸš¨ ä½ çš„ fpath è¢«é‡å¤æ³¨å…¥äº†åŒæ ·çš„ç›®å½• 4 æ¬¡ä»¥ä¸Š ...

è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨åŠ è½½æ’ä»¶å‰ï¼Œå…ˆç”¨ `typeset -U fpath` æ¥å»é‡ fpath å˜é‡å³å¯ã€‚

æœ€ç»ˆçš„ ~/.zshrc ç›¸å…³éƒ¨åˆ†å†…å®¹å¦‚ä¸‹ï¼Œå±•ç¤ºå¯åŠ¨æ—¶é—´è€—æ—¶çš„å‘½ä»¤ `zmodload zsh/zprof` / `zprof` å–æ¶ˆæ³¨é‡Šå°±å¯ä»¥çœ‹åˆ°å¯åŠ¨æ—¶æ¯ä¸ªæ­¥éª¤çš„è€—æ—¶ã€‚

```bash
# --- file start
# perf start
# zmodload zsh/zprof

# Disable compinit security check && disable auto update
ZSH_DISABLE_COMPFIX="true"
DISABLE_AUTO_UPDATE="true"

# ....everything else...

typeset -U fpath

plugins=(git virtualenv zsh-autosuggestions zsh-syntax-highlighting)

source $ZSH/oh-my-zsh.sh

# perf end
# zprof

```

compinit ç¼“å­˜æ–‡ä»¶åœ¨ `~/.zcompdump*`ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ é™¤å®ƒæ¥å¼ºåˆ¶ zsh é‡æ–°ç”Ÿæˆç¼“å­˜æ–‡ä»¶ã€‚
